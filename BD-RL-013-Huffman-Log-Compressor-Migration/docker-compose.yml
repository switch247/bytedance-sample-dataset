version: '3.8'
services:
  after:
    build:
      context: .
    volumes:
      - ./:/app
    working_dir: /app
    # run Go tests when invoking `docker compose run --rm after`
    command: ["go", "test", "./...", "-v"]

  before:
    build:
      context: .
    volumes:
      - ./:/app
    working_dir: /app
    # run Python tests when invoking `docker compose run --rm before`
    command: ["python3", "-m", "pytest", "-v"]

  evaluation:
    build:
      context: .
    volumes:
      - ./:/app
    working_dir: /app
    # run the evaluation script which will invoke docker-compose runs for before/after
    command: ["python3", "evaluation/evaluation.py"]
